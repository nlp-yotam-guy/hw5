2019-06-16 17:49:37,929:INFO: Building model...
2019-06-16 17:49:37,945:WARNING: From /Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
2019-06-16 17:49:38,828:WARNING: From /Users/yotammanne/Documents/NLP/hw/hw5/rnn.py:290: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2019-06-16 17:49:40,710:WARNING: From /Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/tensorflow/python/ops/array_grad.py:425: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-06-16 17:49:46,265:INFO: took 8.34 seconds
2019-06-16 17:49:47,932:INFO: Epoch 1 out of 10
2019-06-16 17:52:43,378:INFO: Evaluating on development data
2019-06-16 17:54:40,113:DEBUG: Token-level confusion matrix:
go\gu   	PER     	ORG     	LOC     	MISC    	O       
PER     	2848.00 	113.00  	50.00   	13.00   	125.00  
ORG     	324.00  	1232.00 	202.00  	136.00  	198.00  
LOC     	117.00  	298.00  	1511.00 	93.00   	75.00   
MISC    	82.00   	169.00  	88.00   	810.00  	119.00  
O       	102.00  	123.00  	20.00   	56.00   	42458.00

2019-06-16 17:54:40,113:DEBUG: Token-level scores:
label	acc  	prec 	rec  	f1   
PER  	0.98 	0.82 	0.90 	0.86 
ORG  	0.97 	0.64 	0.59 	0.61 
LOC  	0.98 	0.81 	0.72 	0.76 
MISC 	0.99 	0.73 	0.64 	0.68 
O    	0.98 	0.99 	0.99 	0.99 
micro	0.98 	0.95 	0.95 	0.95 
macro	0.98 	0.80 	0.77 	0.78 
not-O	0.98 	0.76 	0.74 	0.75 

2019-06-16 17:54:40,113:INFO: Entity level P/R/F1: 0.65/0.69/0.67
2019-06-16 17:54:40,113:INFO: New best score! Saving model in results/rnn/20190616_174934/model.weights
2019-06-16 17:54:41,119:INFO: Epoch 2 out of 10
2019-06-16 17:57:27,665:INFO: Evaluating on development data
2019-06-16 17:59:33,873:DEBUG: Token-level confusion matrix:
go\gu   	PER     	ORG     	LOC     	MISC    	O       
PER     	2853.00 	162.00  	57.00   	4.00    	73.00   
ORG     	169.00  	1598.00 	140.00  	31.00   	154.00  
LOC     	58.00   	314.00  	1654.00 	12.00   	56.00   
MISC    	45.00   	211.00  	91.00   	789.00  	132.00  
O       	70.00   	118.00  	22.00   	24.00   	42525.00

2019-06-16 17:59:33,873:DEBUG: Token-level scores:
label	acc  	prec 	rec  	f1   
PER  	0.99 	0.89 	0.91 	0.90 
ORG  	0.97 	0.67 	0.76 	0.71 
LOC  	0.99 	0.84 	0.79 	0.82 
MISC 	0.99 	0.92 	0.62 	0.74 
O    	0.99 	0.99 	0.99 	0.99 
micro	0.98 	0.96 	0.96 	0.96 
macro	0.98 	0.86 	0.82 	0.83 
not-O	0.98 	0.82 	0.80 	0.81 

2019-06-16 17:59:33,874:INFO: Entity level P/R/F1: 0.73/0.77/0.75
2019-06-16 17:59:33,874:INFO: New best score! Saving model in results/rnn/20190616_174934/model.weights
2019-06-16 17:59:34,770:INFO: Epoch 3 out of 10
2019-06-16 18:02:30,124:INFO: Evaluating on development data
2019-06-16 18:04:15,042:DEBUG: Token-level confusion matrix:
go\gu   	PER     	ORG     	LOC     	MISC    	O       
PER     	2928.00 	30.00   	101.00  	20.00   	70.00   
ORG     	177.00  	1468.00 	167.00  	117.00  	163.00  
LOC     	48.00   	149.00  	1810.00 	39.00   	48.00   
MISC    	49.00   	50.00   	74.00   	977.00  	118.00  
O       	58.00   	43.00   	24.00   	49.00   	42585.00

2019-06-16 18:04:15,045:DEBUG: Token-level scores:
label	acc  	prec 	rec  	f1   
PER  	0.99 	0.90 	0.93 	0.91 
ORG  	0.98 	0.84 	0.70 	0.77 
LOC  	0.99 	0.83 	0.86 	0.85 
MISC 	0.99 	0.81 	0.77 	0.79 
O    	0.99 	0.99 	1.00 	0.99 
micro	0.99 	0.97 	0.97 	0.97 
macro	0.99 	0.88 	0.85 	0.86 
not-O	0.99 	0.86 	0.83 	0.85 

2019-06-16 18:04:15,045:INFO: Entity level P/R/F1: 0.78/0.81/0.79
2019-06-16 18:04:15,045:INFO: New best score! Saving model in results/rnn/20190616_174934/model.weights
2019-06-16 18:04:15,883:INFO: Epoch 4 out of 10
2019-06-16 18:06:51,274:INFO: Evaluating on development data
2019-06-16 18:08:40,049:DEBUG: Token-level confusion matrix:
go\gu   	PER     	ORG     	LOC     	MISC    	O       
PER     	2894.00 	108.00  	62.00   	14.00   	71.00   
ORG     	120.00  	1683.00 	98.00   	59.00   	132.00  
LOC     	31.00   	211.00  	1797.00 	17.00   	38.00   
MISC    	32.00   	91.00   	63.00   	968.00  	114.00  
O       	40.00   	69.00   	18.00   	32.00   	42600.00

2019-06-16 18:08:40,050:DEBUG: Token-level scores:
label	acc  	prec 	rec  	f1   
PER  	0.99 	0.93 	0.92 	0.92 
ORG  	0.98 	0.78 	0.80 	0.79 
LOC  	0.99 	0.88 	0.86 	0.87 
MISC 	0.99 	0.89 	0.76 	0.82 
O    	0.99 	0.99 	1.00 	0.99 
micro	0.99 	0.97 	0.97 	0.97 
macro	0.99 	0.89 	0.87 	0.88 
not-O	0.99 	0.87 	0.85 	0.86 

2019-06-16 18:08:40,050:INFO: Entity level P/R/F1: 0.80/0.83/0.81
2019-06-16 18:08:40,050:INFO: New best score! Saving model in results/rnn/20190616_174934/model.weights
2019-06-16 18:08:40,928:INFO: Epoch 5 out of 10
2019-06-16 18:11:16,574:INFO: Evaluating on development data
2019-06-16 18:12:58,898:DEBUG: Token-level confusion matrix:
go\gu   	PER     	ORG     	LOC     	MISC    	O       
PER     	2911.00 	64.00   	44.00   	13.00   	117.00  
ORG     	128.00  	1649.00 	84.00   	75.00   	156.00  
LOC     	32.00   	159.00  	1817.00 	30.00   	56.00   
MISC    	37.00   	71.00   	40.00   	1007.00 	113.00  
O       	30.00   	48.00   	14.00   	38.00   	42629.00

2019-06-16 18:12:58,898:DEBUG: Token-level scores:
label	acc  	prec 	rec  	f1   
PER  	0.99 	0.93 	0.92 	0.93 
ORG  	0.98 	0.83 	0.79 	0.81 
LOC  	0.99 	0.91 	0.87 	0.89 
MISC 	0.99 	0.87 	0.79 	0.83 
O    	0.99 	0.99 	1.00 	0.99 
micro	0.99 	0.97 	0.97 	0.97 
macro	0.99 	0.90 	0.87 	0.89 
not-O	0.99 	0.89 	0.86 	0.87 

2019-06-16 18:12:58,898:INFO: Entity level P/R/F1: 0.82/0.83/0.83
2019-06-16 18:12:58,898:INFO: New best score! Saving model in results/rnn/20190616_174934/model.weights
2019-06-16 18:12:59,738:INFO: Epoch 6 out of 10
2019-06-16 18:15:41,031:INFO: Evaluating on development data
2019-06-16 18:17:26,876:DEBUG: Token-level confusion matrix:
go\gu   	PER     	ORG     	LOC     	MISC    	O       
PER     	2941.00 	51.00   	74.00   	16.00   	67.00   
ORG     	138.00  	1669.00 	80.00   	78.00   	127.00  
LOC     	32.00   	150.00  	1853.00 	23.00   	36.00   
MISC    	39.00   	55.00   	45.00   	1023.00 	106.00  
O       	32.00   	53.00   	17.00   	33.00   	42624.00

2019-06-16 18:17:26,877:DEBUG: Token-level scores:
label	acc  	prec 	rec  	f1   
PER  	0.99 	0.92 	0.93 	0.93 
ORG  	0.99 	0.84 	0.80 	0.82 
LOC  	0.99 	0.90 	0.88 	0.89 
MISC 	0.99 	0.87 	0.81 	0.84 
O    	0.99 	0.99 	1.00 	0.99 
micro	0.99 	0.98 	0.98 	0.98 
macro	0.99 	0.91 	0.88 	0.89 
not-O	0.99 	0.89 	0.87 	0.88 

2019-06-16 18:17:26,877:INFO: Entity level P/R/F1: 0.82/0.85/0.83
2019-06-16 18:17:26,877:INFO: New best score! Saving model in results/rnn/20190616_174934/model.weights
2019-06-16 18:17:27,795:INFO: Epoch 7 out of 10
2019-06-16 18:19:59,219:INFO: Evaluating on development data
2019-06-16 18:21:42,782:DEBUG: Token-level confusion matrix:
go\gu   	PER     	ORG     	LOC     	MISC    	O       
PER     	3006.00 	29.00   	47.00   	13.00   	54.00   
ORG     	164.00  	1612.00 	113.00  	82.00   	121.00  
LOC     	45.00   	122.00  	1873.00 	20.00   	34.00   
MISC    	52.00   	34.00   	63.00   	1017.00 	102.00  
O       	49.00   	53.00   	16.00   	39.00   	42602.00

2019-06-16 18:21:42,782:DEBUG: Token-level scores:
label	acc  	prec 	rec  	f1   
PER  	0.99 	0.91 	0.95 	0.93 
ORG  	0.99 	0.87 	0.77 	0.82 
LOC  	0.99 	0.89 	0.89 	0.89 
MISC 	0.99 	0.87 	0.80 	0.83 
O    	0.99 	0.99 	1.00 	0.99 
micro	0.99 	0.98 	0.98 	0.98 
macro	0.99 	0.91 	0.88 	0.89 
not-O	0.99 	0.89 	0.87 	0.88 

2019-06-16 18:21:42,783:INFO: Entity level P/R/F1: 0.82/0.85/0.84
2019-06-16 18:21:42,783:INFO: New best score! Saving model in results/rnn/20190616_174934/model.weights
2019-06-16 18:21:43,739:INFO: Epoch 8 out of 10
2019-06-16 18:24:22,121:INFO: Evaluating on development data
2019-06-16 18:26:12,711:DEBUG: Token-level confusion matrix:
go\gu   	PER     	ORG     	LOC     	MISC    	O       
PER     	2971.00 	53.00   	44.00   	7.00    	74.00   
ORG     	131.00  	1684.00 	97.00   	64.00   	116.00  
LOC     	41.00   	113.00  	1894.00 	10.00   	36.00   
MISC    	41.00   	54.00   	62.00   	1000.00 	111.00  
O       	39.00   	50.00   	16.00   	25.00   	42629.00

2019-06-16 18:26:12,712:DEBUG: Token-level scores:
label	acc  	prec 	rec  	f1   
PER  	0.99 	0.92 	0.94 	0.93 
ORG  	0.99 	0.86 	0.80 	0.83 
LOC  	0.99 	0.90 	0.90 	0.90 
MISC 	0.99 	0.90 	0.79 	0.84 
O    	0.99 	0.99 	1.00 	0.99 
micro	0.99 	0.98 	0.98 	0.98 
macro	0.99 	0.92 	0.89 	0.90 
not-O	0.99 	0.90 	0.88 	0.89 

2019-06-16 18:26:12,712:INFO: Entity level P/R/F1: 0.83/0.85/0.84
2019-06-16 18:26:12,712:INFO: New best score! Saving model in results/rnn/20190616_174934/model.weights
2019-06-16 18:26:14,046:INFO: Epoch 9 out of 10
2019-06-16 18:28:58,913:INFO: Evaluating on development data
2019-06-16 18:30:45,486:DEBUG: Token-level confusion matrix:
go\gu   	PER     	ORG     	LOC     	MISC    	O       
PER     	2950.00 	31.00   	88.00   	12.00   	68.00   
ORG     	118.00  	1671.00 	106.00  	74.00   	123.00  
LOC     	32.00   	126.00  	1892.00 	8.00    	36.00   
MISC    	32.00   	50.00   	74.00   	995.00  	117.00  
O       	30.00   	40.00   	25.00   	22.00   	42642.00

2019-06-16 18:30:45,488:DEBUG: Token-level scores:
label	acc  	prec 	rec  	f1   
PER  	0.99 	0.93 	0.94 	0.93 
ORG  	0.99 	0.87 	0.80 	0.83 
LOC  	0.99 	0.87 	0.90 	0.88 
MISC 	0.99 	0.90 	0.78 	0.84 
O    	0.99 	0.99 	1.00 	0.99 
micro	0.99 	0.98 	0.98 	0.98 
macro	0.99 	0.91 	0.88 	0.90 
not-O	0.99 	0.90 	0.87 	0.88 

2019-06-16 18:30:45,488:INFO: Entity level P/R/F1: 0.83/0.85/0.84
2019-06-16 18:30:45,488:INFO: Epoch 10 out of 10
2019-06-16 18:33:20,321:INFO: Evaluating on development data
2019-06-16 18:35:05,175:DEBUG: Token-level confusion matrix:
go\gu   	PER     	ORG     	LOC     	MISC    	O       
PER     	2918.00 	28.00   	99.00   	19.00   	85.00   
ORG     	96.00   	1609.00 	141.00  	103.00  	143.00  
LOC     	22.00   	58.00   	1946.00 	25.00   	43.00   
MISC    	31.00   	24.00   	55.00   	1044.00 	114.00  
O       	23.00   	30.00   	20.00   	39.00   	42647.00

2019-06-16 18:35:05,175:DEBUG: Token-level scores:
label	acc  	prec 	rec  	f1   
PER  	0.99 	0.94 	0.93 	0.94 
ORG  	0.99 	0.92 	0.77 	0.84 
LOC  	0.99 	0.86 	0.93 	0.89 
MISC 	0.99 	0.85 	0.82 	0.84 
O    	0.99 	0.99 	1.00 	0.99 
micro	0.99 	0.98 	0.98 	0.98 
macro	0.99 	0.91 	0.89 	0.90 
not-O	0.99 	0.90 	0.87 	0.89 

2019-06-16 18:35:05,175:INFO: Entity level P/R/F1: 0.84/0.85/0.85
2019-06-16 18:35:05,176:INFO: New best score! Saving model in results/rnn/20190616_174934/model.weights
